<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui"
      xmlns:o="http://omnifaces.org/ui"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html">

    <h:body>
        <ui:composition template="/WEB-INF/template.xhtml"  >
            <ui:define name="tituloPagina">
                Iniciativas - Entregables
            </ui:define>
            <ui:define name="content">
                <h:form id="formGeneric">

					<p:commandButton value="Nuevo" style="margin-bottom:  20px;" process="@this"
									 action="#{iniciativaEntregableBean.init}" update=":formGeneric:paneList, formGeneric:panelEdit">
						<f:setPropertyActionListener target="#{iniciativaEntregableBean.mostrarEditar}" value="#{true}" />
						<f:setPropertyActionListener target="#{iniciativaEntregableBean.editando}" value="#{false}" />
					</p:commandButton>

					<p:commandButton value="Lista" style="margin-bottom:  20px;" process="@this"
									 action="#{iniciativaEntregableBean.init}" update=":formGeneric:paneList, formGeneric:panelEdit">
						<f:setPropertyActionListener target="#{iniciativaEntregableBean.mostrarEditar}" value="#{false}" />
						<f:setPropertyActionListener target="#{iniciativaEntregableBean.editando}" value="#{true}" />
					</p:commandButton>

					<h:panelGroup  id="paneList" >
						<h:panelGroup rendered="#{!iniciativaEntregableBean.mostrarEditar}">
							<p:dataTable id="dtGeneric" value="#{iniciativaEntregableBean.lista}" var="row" rows="10" rowKey="#{row.idIniciativa}"
									 paginator="true" paginatorPosition="bottom" >

								<p:column headerText="Tipo Iniciativa">
									<p:outputLabel value="#{row.idTipoIniciativa.codigo}" />
								</p:column>

								<p:column headerText="Nro. Iniciativa">
									<p:outputLabel value="#{row.nroIniciativa}" />
								</p:column>

								<p:column headerText="Nombre">
									<p:outputLabel value="#{row.nombre}" />
								</p:column>

								<p:column headerText="Descripción">
									<p:outputLabel value="#{row.descripcion}" />
								</p:column>

								<p:column headerText="Multiples Entregables">
									<p:outputLabel value="#{row.multiplesEntregables eq true ? 'Si' : 'No'}" />
								</p:column>

								<p:column headerText="Activo">
									<p:outputLabel value="#{row.activo eq true ? 'Si' : 'No'}" />
								</p:column>


								<p:column headerText="Acción">
									<center>
										<p:commandButton icon="fa fa-pencil Fs100 Red" title="Editar"
														 update=":formGeneric:paneList :formGeneric:panelEdit :formGeneric:accTareas:dtEntregable"
														 action="#{iniciativaEntregableBean.editarDT}">
											<f:setPropertyActionListener value="#{row}" target="#{iniciativaEntregableBean.selected}" />
											<f:setPropertyActionListener value="#{true}" target="#{iniciativaEntregableBean.editando}" />
										</p:commandButton>

										<p:commandButton icon="fa fa-minus-circle Fs100 Red" title="Eliminar"
														 action="#{iniciativaEntregableBean.eliminar}" update="formGeneric:dtGeneric formGrowl:growl">
											<f:setPropertyActionListener value="#{row}" target="#{iniciativaEntregableBean.selected}" />
											<p:confirm header="Confirmación" message="Estas seguro?" icon="pi pi-exclamation-triangle" />
										</p:commandButton>
									</center>
								</p:column>

							</p:dataTable>
						</h:panelGroup>
					</h:panelGroup>


					<h:panelGroup id="panelEdit">
						<h:panelGroup rendered="#{iniciativaEntregableBean.mostrarEditar}">
							<p:accordionPanel id="accTareas" cache="false" multiple="true">
								<p:tab title="Nueva Iniciativa" id="inicitivaTab">
									<div class="bd-example">

										<div class="form-group row">
											<label for="selPro" class="col-sm-2 col-form-label">Tipo Iniciativa</label>
											<div class="col-sm-10">
												<p:selectOneMenu id="selPro" value="#{iniciativaEntregableBean.tipoIniciativaSelected}"
																 converter="omnifaces.SelectItemsConverter" style="width: 100%">

													<f:selectItems value="#{iniciativaEntregableBean.tipoIniciativaList}"
																   var="row" itemLabel="#{row.codigo}" itemValue="#{row}" />
												</p:selectOneMenu>
											</div>
										</div>

										<div class="form-group row">
											<label for="nroini" class="col-sm-2 col-form-label">Nro. Iniciativa</label>
											<div class="col-sm-10">
												<p:inputText id="nroini" styleClass="form-control" required="false"
															 value="#{iniciativaEntregableBean.selected.nroIniciativa}"/>
											</div>
										</div>



										<div class="form-group row">
											<label for="codigo" class="col-sm-2 col-form-label">Nombre</label>
											<div class="col-sm-10">
												<p:inputText id="codigo" styleClass="form-control" required="false"
															 value="#{iniciativaEntregableBean.selected.nombre}"/>
											</div>
										</div>

										<div class="form-group row">
											<label for="nombre" class="col-sm-2 col-form-label">Descripción</label>
											<div class="col-sm-10">
												<p:inputText id="nombre" styleClass="form-control" required="false"
															 value="#{iniciativaEntregableBean.selected.descripcion}"/>
											</div>
										</div>

										<div class="form-group row">
											<label  class="col-sm-2 col-form-label">Multiples Entregables</label>
											<div class="col-sm-10">
												<p:selectBooleanCheckbox required="false"
																		 value="#{iniciativaEntregableBean.selected.multiplesEntregables}"/>
											</div>
										</div>

										<div class="form-group row">
											<label for="nombre" class="col-sm-2 col-form-label">Activo</label>
											<div class="col-sm-10">
												<p:selectBooleanCheckbox required="false"
																		 value="#{iniciativaEntregableBean.selected.activo}"/>
											</div>
										</div>




									</div>
								</p:tab>

								<p:tab title="Datos de Entregables" id="entregablesTab">
									<h:panelGroup id="datosEntregable">


										<div class="form-group row">
											<label  class="col-sm-2 col-form-label">Nro. Entregable</label>
											<div class="col-sm-10">
												<p:inputText  styleClass="form-control" required="false"
															  value="#{iniciativaEntregableBean.nroEntregable}"/>
											</div>
										</div>



										<div class="form-group row">
											<label  class="col-sm-2 col-form-label">Nombre</label>
											<div class="col-sm-10">
												<p:inputText  styleClass="form-control" required="false"
															  value="#{iniciativaEntregableBean.nombreEntregable}"/>
											</div>
										</div>

										<div class="form-group row">
											<label  class="col-sm-2 col-form-label">Descripción</label>
											<div class="col-sm-10">
												<p:inputText styleClass="form-control" required="false"
															 value="#{iniciativaEntregableBean.descripcionEntregable}"/>
											</div>
										</div>


										<div class="form-group row">
											<label  class="col-sm-2 col-form-label">Activo</label>
											<div class="col-sm-10">
												<p:selectBooleanCheckbox required="false"
																		 value="#{iniciativaEntregableBean.activoEntregable}"/>
											</div>
										</div>

									</h:panelGroup>

									<div class="float-sm-left" style="padding-top: 10px;">
										<p:commandButton value="Agregar" ajax="true" icon="fa fa-plus-circle"
														 process="@this formGeneric:accTareas:datosEntregable"
														 update="formGeneric:accTareas:dtEntregable formGeneric:accTareas:datosEntregable"
														 action="#{iniciativaEntregableBean.agregarListaEntregables}"
														 >

										</p:commandButton>
									</div>



									<p:dataTable id="dtEntregable" value="#{iniciativaEntregableBean.listaEntregables}"
												 var="rowEntregable" rows="10" rowKey="#{rowEntregable.idEntregable}"
												 paginator="true" paginatorPosition="bottom"
												 style="padding-top: 60px;width: 100%;padding-bottom: 30px;"
												 editable="true" editMode="cell">
										<f:facet name="header">
											Lista de entregables
										</f:facet>
										<p:column headerText="Nro. Entregable">
											<p:cellEditor>
												<f:facet name="output"><p:outputLabel value="#{rowEntregable.nroEntregable}" /></f:facet>
												<f:facet name="input"><p:inputText  value="#{rowEntregable.nroEntregable}" /></f:facet>
											</p:cellEditor>
										</p:column>

										<p:column headerText="Nombre">
											<p:cellEditor>
												<f:facet name="output"><p:outputLabel value="#{rowEntregable.nombre}" /></f:facet>
												<f:facet name="input"><p:inputText  value="#{rowEntregable.nombre}" /></f:facet>
											</p:cellEditor>

										</p:column>

										<p:column headerText="Descripción">
											<p:cellEditor>
												<f:facet name="output"><p:outputLabel value="#{rowEntregable.descripcion}" /></f:facet>
												<f:facet name="input"><p:inputText  value="#{rowEntregable.descripcion}" /></f:facet>
											</p:cellEditor>
										</p:column>

										<p:column headerText="Activo">
											<p:cellEditor>
												<f:facet name="output"><h:outputText value="#{rowEntregable.activo eq true ? 'Si': 'No'}" /></f:facet>
												<f:facet name="input">
													<h:selectOneMenu value="#{rowEntregable.activo}" style="width:100%">
														<f:selectItem  itemValue="#{true}" itemLabel="Si"/>
														<f:selectItem  itemValue="#{false}" itemLabel="No"/>
													</h:selectOneMenu>
												</f:facet>
											</p:cellEditor>
										</p:column>

										<p:column headerText="Acción">
											<p:commandButton icon="fa fa-minus-circle Fs100 Red" title="Eliminar"
															 action="#{iniciativaEntregableBean.eliminarEntregable}" update="formGeneric:accTareas:dtEntregable formGrowl:growl">
												<f:setPropertyActionListener value="#{rowEntregable}" target="#{iniciativaEntregableBean.entregableSeleccionado}" />
												<p:confirm header="Confirmación" message="Estas seguro?" icon="pi pi-exclamation-triangle" />
											</p:commandButton>
										</p:column>

									</p:dataTable>


									<p:commandButton  styleClass="ui-priority-primary" value="Guardar"
													  action="#{iniciativaEntregableBean.guardar}"
													  style="margin-top: 20px;"
													  update="formGeneric:dtGeneric formGrowl:growl :formGeneric:paneList, formGeneric:panelEdit"
													  process="@this @form"
													  rendered="#{!iniciativaEntregableBean.editando}" >
										<f:setPropertyActionListener target="#{iniciativaEntregableBean.mostrarEditar}" value="#{false}" />
									</p:commandButton>

									<p:commandButton  styleClass="ui-priority-primary" value="Actualizar"
													  action="#{iniciativaEntregableBean.actualizar}"
													  update="formGeneric:dtGeneric formGrowl:growl :formGeneric:paneList, formGeneric:panelEdit"
													  process="@this @form"
													  rendered="#{iniciativaEntregableBean.editando}" >
										<f:setPropertyActionListener target="#{iniciativaEntregableBean.mostrarEditar}" value="#{false}" />
									</p:commandButton>


									<p:commandButton  styleClass="ui-priority-secondary" value="Salir"
													  update=":formGeneric:paneList, formGeneric:panelEdit" process="@this">
											<f:setPropertyActionListener target="#{iniciativaEntregableBean.mostrarEditar}" value="#{false}" />
									</p:commandButton>


								</p:tab>
							</p:accordionPanel>




						</h:panelGroup>
					</h:panelGroup>





                    <!--div class="float-sm-right" style="padding-top: 10px;">
                        <p:commandButton value="Agregar" ajax="true" icon="fa fa-plus-circle"
                                         oncomplete="PF('wbGeneric').show();"
                                         actionListener="#{iniciativaEntregableBean.agregar}"
                                         update="formDlgGeneric">
                            <f:setPropertyActionListener value="#{false}" target="#{iniciativaEntregableBean.editando}" />
                        </p:commandButton>
                    </div-->
                    <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                        <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="pi pi-check" />
                        <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="pi pi-times" />
                    </p:confirmDialog>
                </h:form>


            </ui:define>

        </ui:composition>
    </h:body>
</html>


